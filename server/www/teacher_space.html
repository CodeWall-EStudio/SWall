<!DOCTYPE html>
<html ng-app="TeacherSpace">
<head>
    <title>教师空间</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link href="lib/bootstrap_3.0.3/css/bootstrap.min.css" rel="stylesheet">
    <link href="css/teacherSpace.min.css?20131225001" rel="stylesheet">
    <script src="lib/jquery-2.0.3.min.js"></script>
    <script src="lib/angular_1.2.6.min.js"></script>
</head>
<body class="fixedTopNavbar" ng-controller="MainController">

    <!-- 顶部的导航栏 -->
    <div class="navbar navbar-default navbar-fixed-top" ng-controller="NavigatorController">
        <div class="container">
            <div class="navbar-header">
                <a class="navbar-brand">教师空间</a>
            </div>
            <div class="collapse navbar-collapse">
                <ul class="nav navbar-nav">
                    <li class="active"><a>浏览活动</a></li>
                    <li><a>管理活动</a></li>
                </ul>
                <ul class="nav navbar-nav navbar-right">
                    <li><a>{{username}}</a></li>
                </ul>
            </div>
        </div>
    </div>
    <div class="container">

        <!-- 工具栏 -->
        <div class="row" ng-controller="ToolbarController">
            <div class="col-sm-12">
                <div class="navbar navbar-default">
                    <div class="collapse navbar-collapse">
                        <ul class="nav navbar-nav">
                            <li><a data-toggle="modal" data-target="#createActivityModal">创建活动</a></li>
                        </ul>
                        <form class="navbar-form navbar-right">
                            <div class="form-group">
                                <input type="text" class="form-control" placeholder="搜索活动" ng-model="searchKeyword">
                            </div>
                        </form>
                        <ul class="nav navbar-nav navbar-right">
                            <li class="dropdown">
                                <a class="dropdown-toggle" data-toggle="dropdown">
                                    {{authorizationTypes[aTypeIndex].label}} <b class="caret"></b>
                                </a>
                                <ul class="dropdown-menu">
                                    <li ng-repeat="atype in authorizationTypes"
                                        ng-class="{active:aTypeIndex==$index}"
                                        ng-click="updateQueryCondition('aTypeIndex', $index)">
                                        <a>{{atype.label}}</a>
                                    </li>
                                </ul>
                            </li>
                            <li class="dropdown">
                                <a class="dropdown-toggle" data-toggle="dropdown">
                                    {{statuses[statusIndex].label}} <b class="caret"></b>
                                </a>
                                <ul class="dropdown-menu">
                                    <li ng-repeat="status in statuses"
                                        ng-class="{active:statusIndex==$index}"
                                        ng-click="updateQueryCondition('statusIndex', $index)">
                                        <a>{{status.label}}</a>
                                    </li>
                                </ul>
                            </li>
                        </ul>
                    </div>
                </div>
            </div>
        </div>

        <!-- 活动列表和内容 -->
        <div class="row" ng-controller="ActivityListController">
            <div class="col-sm-3">
                <div class="panel-group" id="activities">
                    <div class="panel panel-default" ng-repeat="item in activityList">
                        <div data-toggle="collapse" data-parent="#activities" ng-href="#{{item.date}}" class="panel-heading">
                            <h4 class="panel-title" activity-date></h4>
                        </div>
                        <div id="{{item.date}}" class="panel-collapse collapse" ng-class="{in:$first}">
                            <div class="list-group">
                                <a class="list-group-item activityItem"
                                   ng-repeat="activity in item.activities"
                                   ng-class="{active:activityID==activity._id}"
                                   ng-click="selectActivity(activity._id)">
                                    {{activity.info.title}}
                                </a>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            <div class="col-sm-8" ng-controller="ActivityDetailController">
                <div ng-show="activity">
                    <h3>{{activity.info.title}}</h3>
                    <p>状态：{{activity.active ? '开放' : '关闭'}}的活动</p>
                    <p><button type="button" class="btn btn-primary">{{activity.active ? '展示' : '回放'}}</button></p>
                    <p ng-switch on="activity.info.type">
                        活动类型：
                        <span ng-switch-when="1">公开课</span>
                        <span ng-switch-default>未知类型</span>
                    </p>
                    <p>活动简介：{{activity.info.desc}}</p>
                    <br/>
                    <p>出课教师：{{activity.info.teacher}}</p>
                    <p>年级：{{activity.info.grade}}</p>
                    <p>学科：{{activity.info.subject}}</p>
                    <p>班级：{{activity.info.grade}}{{activity.info.class}}</p>
                    <p>课题：{{activity.info.domain}}</p>
                    <br/>
                    <p>用户：{{userCount()}}位参与者</p>
                    <p>资源：共{{activity.resources.length}}个资源</p>
                </div>
            </div>
        </div>
    </div>

    <div class="modal fade" id="loginModal">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header">
                    <h4 class="modal-title">欢迎</h4>
                </div>
                <div class="modal-body">
                    <form>
                        <div class="form-group">
                            <input type="text" class="form-control input-lg" placeholder="用户名">
                        </div>
                        <div class="form-group">
                            <input type="password" class="form-control input-lg" placeholder="密码">
                        </div>
                    </form>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-primary">登录</button>
                </div>
            </div>
        </div>
    </div>

    <div class="modal fade" id="createActivityModal" ng-controller="ActivityFormController">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header">
                    <h4 class="modal-title">新建活动</h4>
                </div>
                <div class="modal-body">
                    <div class="alert alert-warning" ng-show="errMsg">
                        <strong>完啦出错啦！</strong> {{errMsg}}
                    </div>
                    <form id="createActivityForm" class="form-horizontal">
                        <fieldset>
                            <div class="form-group">
                                <label for="na_title" class="col-sm-2 control-label">活动主题</label>
                                <div class="col-sm-10">
                                    <input type="text" class="form-control input-sm" id="na_title" ng-model="title">
                                </div>
                            </div>
                            <div class="form-group">
                                <label for="na_type" class="col-sm-2 control-label">活动类型</label>
                                <div class="col-sm-4">
                                    <select class="form-control input-sm" id="na_type" ng-model="type">
                                        <option ng-repeat="type in config.activityConfig.types" value="{{type.value}}">{{type.label}}</option>
                                    </select>
                                </div>
                                <label for="na_date" class="col-sm-2 control-label">日期时间</label>
                                <div class="col-sm-4">
                                    <input type="text" class="form-control input-sm" id="na_date" ng-model="date" activity-date-picker>
                                </div>
                            </div>
                            <div class="form-group">
                                <label for="na_desc" class="col-sm-2 control-label">活动简介</label>
                                <div class="col-sm-10">
                                    <textarea class="form-control input-sm" rows="3" id="na_desc" ng-model="desc" placeholder="可选填"></textarea>
                                </div>
                            </div>
                            <div class="form-group">
                                <label for="na_teacher" class="col-sm-2 control-label">出课教师</label>
                                <div class="col-sm-10">
                                    <input type="text" class="form-control input-sm" id="na_teacher" ng-model="teacher">
                                </div>
                            </div>
                            <div class="form-group">
                                <label for="na_grade" class="col-sm-2 control-label">年级</label>
                                <div class="col-sm-2">
                                    <select class="form-control input-sm" id="na_grade" ng-model="grade">
                                        <option ng-repeat="grade in config.activityConfig.classes" value="{{$index}}">
                                            {{grade.grade}}
                                        </option>
                                    </select>
                                </div>
                                <label for="na_subject" class="col-sm-2 control-label">学科</label>
                                <div class="col-sm-2">
                                    <select class="form-control input-sm" id="na_subject" ng-model="subject">
                                        <option ng-repeat="subject in config.activityConfig.subjects" value="{{$index}}">
                                            {{subject}}
                                        </option>
                                    </select>
                                </div>
                                <label for="na_class" class="col-sm-2 control-label">班级</label>
                                <div class="col-sm-2">
                                    <select class="form-control input-sm" id="na_class" ng-model="cls">
                                        <option ng-repeat="cls in config.activityConfig.classes[grade].cls" value="{{$index}}">
                                            {{cls}}
                                        </option>
                                    </select>
                                </div>
                            </div>
                            <div class="form-group">
                                <label for="na_domain" class="col-sm-2 control-label">课题</label>
                                <div class="col-sm-10">
                                    <input type="text" class="form-control input-sm" id="na_domain" ng-model="domain">
                                </div>
                            </div>
                            <div class="form-group">
                                <label for="na_users" class="col-sm-2 control-label">权限</label>
                                <div class="col-sm-10">
                                    <input type="text" id="na_users" data-role="tagsinput" ng-model="invitedUsers">
                                </div>
                            </div>
                        </fieldset>
                    </form>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-primary" ng-click="createActivity()">新建活动</button>
                    <button type="button" class="btn btn-default" data-dismiss="modal">取消</button>
                </div>
            </div>
        </div>
    </div>

    <script src="lib/bootstrap_3.0.3/js/bootstrap.min.js"></script>
    <script src="lib/underscore_1.5.2.min.js"></script>
    <script src="js/teacherSpace.min.js?20131225001"></script>
</body>
</html>